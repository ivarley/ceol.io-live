{% extends "base.html" %}

{% block content %}
<div class="landing-page" style="display: block;">

{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible" role="alert" style="margin-bottom: 20px;">
                {{ message }}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close" onclick="this.parentElement.style.display='none'">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        {% endfor %}
    {% endif %}
{% endwith %}

<div style="margin-top: 20px; margin-bottom: 30px;">
    {% if current_user.is_authenticated %}

        <h5>Learn Tunes</h5>
        <ul style="list-style: none; padding-left: 0;">
            <li><em><a href="/my-tunes?learn_status=learning">{{ learning_count }} tune{{ 's' if learning_count != 1 else '' }} in progress</a></em></li>
            <li><a href="/my-tunes?learn_status=want+to+learn">{{ want_to_learn_count }} tune{{ 's' if want_to_learn_count != 1 else '' }} to learn</a></li>
            {% if suggested_tune %}
                <li>{{ 'A' if (learning_count + want_to_learn_count) == 0 else 'Another' }} common tune you should learn: <a href="/tunes/{{ suggested_tune.tune_id }}">{{ suggested_tune.name }}</a> ({{ suggested_tune.tune_type }})</li>
            {% endif %}
        </ul>

        <h5>Upcoming Sessions</h5>
        {% if upcoming_sessions %}
            <ul style="list-style: none; padding-left: 0;">
                {% for s in upcoming_sessions %}
                    <li>
                        <a href="/sessions/{{ s.path }}/{{ s.date }}">{{ s.name }}</a>
                        &mdash; {{ s.date.strftime('%A, %b %-d') }}
                        {% if s.log_complete_date %}
                            <span class="text-muted">(log complete)</span>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="text-muted">No sessions scheduled this week.</p>
        {% endif %}

    {% else %}

        <a href="/login" class="btn btn-primary" style="display: block; width: 100%; max-width: 400px; margin-bottom: 20px; color: white;">Log In or Register</a>
        <p style="font-size: 1.15rem;">This app is for traditional Irish music sessions and tunes. Keep track of tunes you know or want to learn, see what's popular in different sessions, and log what you play in your session.</p>
        <p style="font-size: 1.15rem;">If you don't want to create an account, you can still <a href="/sessions">browse sessions</a>.</p>

    {% endif %}
</div>

<!-- end landing page -->
</div>
{% endblock %}
